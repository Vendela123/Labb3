<UserControl x:Class="Labb3.Views.PlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:conv="clr-namespace:Labb3.Converters">

    <UserControl.Resources>
        <conv:AnswerCorrectConverter x:Key="AnswerCorrectConverter"/>
    </UserControl.Resources>

    <Grid Background="#D6FFFF">

        <TextBlock Text="{Binding TimerText}"
                   FontSize="36" FontWeight="Bold"
                   HorizontalAlignment="Right"
                   VerticalAlignment="Top"
                   Margin="0,12,20,0"/>

        <StackPanel HorizontalAlignment="Center"
            VerticalAlignment="Top"
            Margin="0,40,0,20"
            Width="900">

            <TextBlock Text="{Binding CurrentQuestion.Text}"
               FontSize="36"
               LineHeight="48"
               FontWeight="SemiBold"
               TextAlignment="Center"
               TextWrapping="Wrap"
               Margin="0,0,0,20"
               MaxWidth="900"/>

            <TextBlock Text="{Binding CurrentStatus}"
               FontSize="18"
               LineHeight="48"
               Opacity="0.6"
               TextAlignment="Center"
               Margin="0,0,0,10"/>
        </StackPanel>

        <ItemsControl ItemsSource="{Binding ShuffledAnswers}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Margin="0,40,0,0">

            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Rows="2" Columns="2"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>

            <ItemsControl.ItemTemplate>
                <DataTemplate>

                    <Button Content="{Binding}"
                            Height="110" Width="320"
                            FontSize="18"
                            Margin="18"
                            Padding="8"
                            Command="{Binding DataContext.AnswerCommand,
                                              RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}">

                        <Button.Template>
                            <ControlTemplate TargetType="Button">

                                <Grid>
                                    <Border x:Name="border"
                                            Background="White"
                                            BorderBrush="#999"
                                            BorderThickness="1"
                                            CornerRadius="6"/>

                                    <StackPanel Orientation="Horizontal"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center">

                                        <Image x:Name="icon"
                                               Width="26" Height="26"
                                               Margin="0,0,8,0"
                                               Visibility="Collapsed"/>

                                        <TextBlock Text="{TemplateBinding Content}"
                                                   VerticalAlignment="Center"
                                                   FontSize="18"/>
                                    </StackPanel>
                                </Grid>

                                <ControlTemplate.Triggers>

                                    <DataTrigger Value="Correct">
                                        <DataTrigger.Binding>
                                            <MultiBinding Converter="{StaticResource AnswerCorrectConverter}">
                                                <Binding />
                                                <Binding Path="DataContext.CurrentQuestion"
                                                         RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                                            </MultiBinding>
                                        </DataTrigger.Binding>

                                        <Setter TargetName="border" Property="Background" Value="#C8E6C9"/>
                                        <Setter TargetName="border" Property="BorderBrush" Value="Green"/>
                                        <Setter TargetName="icon" Property="Source" Value="/Labb3;component/Icons/correct.png"/>
                                        <Setter TargetName="icon" Property="Visibility" Value="Visible"/>
                                    </DataTrigger>

                                    <DataTrigger Value="Wrong">
                                        <DataTrigger.Binding>
                                            <MultiBinding Converter="{StaticResource AnswerCorrectConverter}">
                                                <Binding />
                                                <Binding Path="DataContext.CurrentQuestion"
                                                         RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                                            </MultiBinding>
                                        </DataTrigger.Binding>

                                        <Setter TargetName="border" Property="Background" Value="#FFCDD2"/>
                                        <Setter TargetName="border" Property="BorderBrush" Value="Red"/>
                                        <Setter TargetName="icon" Property="Source" Value="/Labb3;component/Icons/wrong.png"/>
                                        <Setter TargetName="icon" Property="Visibility" Value="Visible"/>
                                    </DataTrigger>

                                </ControlTemplate.Triggers>

                            </ControlTemplate>
                        </Button.Template>

                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>

        </ItemsControl>

    </Grid>
</UserControl>
